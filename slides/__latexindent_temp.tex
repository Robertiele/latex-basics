\documentclass[brazilian]{beamer}

\usetheme{CambridgeUS}
\usecolortheme{beaver}

\usepackage[utf8]{inputenc}
\usepackage{babel}
\usepackage{caption}
\usepackage[nameinlink,capitalise]{cleveref}
\hypersetup{
    final=true,
    unicode=true,
    pdftoolbar=true, 
    pdfmenubar=true,
    pdffitwindow=true, 
    pdfstartview={FitW},  
    pdftitle={Inserir Tabelas}, 
    pdfauthor={Nightwind},
    pdfkeywords={latex, dicas}, 
    pdfnewwindow=true,
    colorlinks=false,
    linkcolor=red,
    citecolor=green,
    filecolor=cyan,
    urlcolor=magenta
}
\usepackage[style=abnt]{biblatex}
\addbibresource{references.bib}
\usepackage{csquotes}

\usepackage{tabularx}
\usepackage{array}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{fontspec}
\setsansfont{Syne}
\setmonofont{Space Mono}
\usefonttheme[onlymath]{serif}

\usepackage{xcolor}

\usepackage{listings}
\input{setup_listings.tex}

\usepackage{menukeys}


\title{Inserir Tabelas}
\author{Nightwind}
\institute[CTISM]{Colégio Técnico Industrial de Santa Maria}
\logo{\includegraphics[width=1cm]{../images/photo1.jpg}}
\date{\today}

\begin{document}

\frame{\titlepage}

\begin{frame}
  \frametitle{Sumário}
  \tableofcontents
\end{frame}

\section{Introdução}
\begin{frame}
  \frametitle{Introdução}

  As tabelas são um ambiente que demanda uma atenção e um cuidado maior. Elas têm uma estrutura bastante rígida e é fácil de se perder quando tem muitas linhas. Por esse motivo, sugiro que utilize sites que gerem o código da tabela, como o \href{https://www.tablesgenerator.com/}{Tables Generator}. Entretanto, em casos de tabelas mais específicas, é válido conhecer pacotes e tratamentos que se adequarão de maneira mais apropriada à situação.

\end{frame}

\begin{frame}
  \frametitle{Introdução}

  Existem comandos comuns ao ambiente de tabelas. Eles serão mostrados nos seguintes slides.

\end{frame}

\begin{frame}[fragile]
  \frametitle{Introdução}


  \begin{table}
    \caption{Como descrever a posição da tabela.}
    \label{tab:Posicao}
    \begin{tabular}[c]{c|c|m{8cm}}
      \firsthline
      \multicolumn{2}{c}{Comando} & Descrição                                                                             \\ \hline
      \multirow{3}{*}{pos}        & \texttt{t}       & A linha inicial da tabela é alinhada com a linha de base do texto. \\ \cline{2-3}
                                  & \texttt{b}       & A linha final da tabela é alinhada com a linha de base do texto.   \\ \cline{2-3}
                                  & \texttt{c} (opc) & A tabela é alinhada com  o centro da linha de base do texto.       \\ \hline
    \end{tabular}
  \end{table}

\end{frame}

\begin{frame}[fragile]
  \frametitle{Introdução}
  \footnotesize

  \begin{table}
    \caption{Como descrever as colunas.}
    \label{tab:Colunas}
    \begin{tabular}[c]{c|c|m{8cm}}
      \firsthline
      \multicolumn{2}{c}{Comando} & Descrição                                                                                                  \\ \hline
      \multirow{9}{*}{cols}       & \texttt{l}            & Conteúdo alinhado à esquerda.                                                      \\ \cline{2-3}
                                  & \texttt{r}            & Conteúdo alinhado à direita.                                                       \\ \cline{2-3}
                                  & \texttt{c}            & Conteúdo centralizado.                                                             \\ \cline{2-3}
                                  & \texttt{p\{<width>\}} & Conteúdo alinhado verticalmente ao topo da célula.                                 \\ \cline{2-3}
                                  & \texttt{m\{<width>\}} & Conteúdo alinhado verticalmente ao centro da célula (com pacote \texttt{array}).   \\ \cline{2-3}
                                  & \texttt{b\{<width>\}} & Conteúdo alinhado verticalmente ao inferior da célula (com pacote \texttt{array}). \\ \cline{2-3}
                                  & |                     & Uma linha entre as colunas.                                                        \\ \cline{2-3}
                                  & ||                    & Duas linhas entre as colunas.                                                      \\ \hline
    \end{tabular}
  \end{table}


  A largura pode ser em cm, mm, in, em, ex, pt.
\end{frame}

\begin{frame}[fragile]
  \frametitle{Introdução}
  \footnotesize

  \begin{table}
    \caption{Comandos para o conteúdo da tabela.}
    \label{tab:Conteudo}
    \begin{tabular}[c]{c|c|m{5cm}}
      \firsthline
      \multicolumn{2}{c}{Comando}           & Descrição                                                                                                                     \\ \hline
      \multirow{6}{2cm}{Conteúdo da Tabela} & \texttt{\&}                                     & Separador de coluna.                                                        \\ \cline{2-3}
                                            & \lstinline[style=myStyleLatex]!\\!              & Nova linha.                                                                 \\ \cline{2-3}
                                            & \lstinline[style=myStyleLatex]!\newline!        & Nova linha.                                                                 \\ \cline{2-3}
                                            & \lstinline[style=myStyleLatex]!\tabularnewline! & Nova linha (com pacote \texttt{array}).                                     \\ \cline{2-3}
                                            & \lstinline[style=myStyleLatex]!\hline!          & Linha divisória entre linhas.                                               \\ \cline{2-3}
                                            & \lstinline[style=myStyleLatex]!\cline{i-j}!     & Linha divisória entre linhas, iniciando na coluna \(i\) até a coluna \(j\). \\ \hline
    \end{tabular}
  \end{table}
\end{frame}

\section{Tabular}
\begin{frame}[fragile]
  \frametitle{Tabular}

  \begin{itemize}
    \item O ambiente \texttt{tabular} é o ambiente para tabelas mais básico.
    \item Todos os comandos das \cref{tab:Colunas,tab:Posicao,tab:Conteudo}.
  \end{itemize}
  \begin{lstlisting}[style=myStyleLatex]
    \begin{tabular}[<pos>]{<cols>}
      ... & ... \\ 
    \end{tabular}
  \end{lstlisting}
\end{frame}

\section{Tabularx}
\begin{frame}[fragile]
  \frametitle{Tabularx}

  \begin{itemize}
    \item O ambiente \texttt{tabularx} é muito similar ao \texttt{tabular}, a diferença é que ele controla a largura total da tabela também.
  \end{itemize}

  \begin{lstlisting}[style=myStyleLatex]
    \begin{tabularx}{<width>}{<cols>}
      
    \end{tabularx}
  \end{lstlisting}

\end{frame}

\begin{frame}[fragile]
  \frametitle{Tabularx: propriedades}

  \begin{itemize}
    \item A largura da tabela pode ser com unidades de medida ou relativa.
    \item As colunas podem ser declaradas da seguinte maneira:
          \begin{itemize}
            \item \lstinline[style=myStyleLatex]!>{\raggedright\arraybackslash}X!: para o texto ficar alinhado à direita (\texttt{raggedright}) e com tamanho variando de acordo com o tamanho total da tabela (\texttt{X}).
            \item \lstinline[style=myStyleLatex]!>{\raggedleft\arraybackslash}X!: para o texto ficar alinhado à esquerda (\texttt{raggedleft}) e com tamanho variando de acordo com o tamanho total da tabela (\texttt{X}).
            \item \lstinline[style=myStyleLatex]!>{\centering\arraybackslash}X!: para o texto ficar centralizado (\texttt{centering}) e com tamanho variando de acordo com o tamanho total da tabela (\texttt{X}).
            \item Para uma coluna com o tamanho variando de acordo com o texto, utilizar o padrão da \cref{tab:Colunas}.
          \end{itemize}
  \end{itemize}

\end{frame}

\begin{frame}[fragile]
  \frametitle{Tabularx: exemplo}
\footnotesize
\begin{lstlisting}[style=myStyleLatex]
\begin{tabularx}{\textwidth}{|| 
  >{\raggedright\arraybackslash}X | 
  >{\raggedleft\arraybackslash}X | 
  >{\centering\arraybackslash}X  ||}
  \hline
  Alinhado à direita & Alinhado à esquerda & Centralizado \\
  \hline
  De acordo com esse alinhamento, o texto pode ser grande que ele automaticamente é adequado à tabela. & 
  De acordo com esse alinhamento, o texto pode ser grande que ele automaticamente é adequado à tabela. & 
  De acordo com esse alinhamento, o texto pode ser grande que ele automaticamente é adequado à tabela. \\
  \hline
\end{tabularx}
\end{lstlisting}

\end{frame}

\section{Longtable}
\begin{frame}[fragile]
  \frametitle{Longtable}

  \begin{itemize}
    \item Este ambiente é dedicado para tabelas que ocupem mais de uma página. 
    \item Não pode ser inserida dentro de um ambiente \lstinline[style=myStyleLatex]!\begin{table}...\end{table}!, já possui o controle de alinhamento, legenda e rótulo intrínseco. 
    \item Não funciona quando o padrão do documento está para duas colunas.
    \item Chamar o pacote \lstinline[style=myStyleLatex]!longtable!.
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Longtable: propriedades}

  \begin{itemize}
    \item A posição segue as opções da \cref{tab:Posicao}.
    \item As colunas seguem as opções da \cref{tab:Colunas}.
    \item Entre a legenda e o rótulo é necessário haver uma quebra de linha.
    \item Todo o conteúdo que vem antes do comando \lstinline[style=myStyleLatex]!endfirsthead! será exibido no começo da tabela.
    \item Todo o conteúdo que vem antes do comando \lstinline[style=myStyleLatex]!endhead! será exibido no começo da tabela em cada folha que a tabela repetir.
    \item Todo o conteúdo que vem antes do comando \lstinline[style=myStyleLatex]!endfoot! será exibido no final da tabela em cada folha que a tabela repetir.
    \item Todo o conteúdo que vem antes do comando \lstinline[style=myStyleLatex]!endlastfoot! será exibido no final da tabela.
    \item Os comando acima não são obrigatórios e são independentes. Sempre que eles são chamados, são formados pelas linhas que os antecedem, iniciados no comando anterior.
  \end{itemize}

\end{frame}

\begin{frame}[fragile]
  \frametitle{Longtable: exemplo}
\tiny
  \begin{lstlisting}[style=myStyleLatex]
    \begin{longtable}[<pos>]{<cols>}
      \caption{<legenda>}
      \label{tab:<rotulo>}\\
      \hline
      Cabeçalho 00 p1 & Cabeçalho 01 & ... \\ 
      \hline
      \endfirsthead
      \hline
      Cabeçalho 00 p2 ...  & Cabeçalho 01 & ... \\ 
      \hline 
      \endhead
      \hline
      Rodapé x0 p2 ... & Rodapé x1 & ... \\ 
      \hline
      \endfoot
      \hline
      Rodapé x0 pn & Rodapé x1 & ... \\ 
      \hline
      \endlastfoot
      
      linha & linha & ... \\
    \end{longtable} 
  \end{lstlisting}

\end{frame}

\section{Formatação}
\begin{frame}[fragile]
  \frametitle{Formatação: mesclagem de colunas}

  \begin{itemize}
    \item 
  \end{itemize}

\end{frame}
\begin{frame}[fragile]
  \frametitle{Formatação: mesclagem de linhas}

  \begin{itemize}
    \item 
  \end{itemize}

\end{frame}
\begin{frame}[fragile]
  \frametitle{Formatação: colorir células, colunas ou linhas}

  \begin{itemize}
    \item 
  \end{itemize}

\end{frame}
\begin{frame}[fragile]
  \frametitle{Formatação: editar as linhas}

  \begin{itemize}
    \item 
  \end{itemize}

\end{frame}

\section{Legenda e rótulo}
\begin{frame}[fragile]
  \frametitle{Legenda e rótulo}

  \begin{itemize}
    \item A legenda é exibida através do comando \lstinline[style=myStyleLatex]!\caption[<short>]{<long>}!.
    \item O texto curto é opcional. Recomenda-se preencher ele quando o texto longo for grande, neste caso, coloca-se um pequeno título nele e ele vai representar a imagem na lista de imagens.
    \item O texto longo é obrigatório. Ele é o texto da legenda.
    \item Se a legenda for \textbf{antes} da tabela, colocar o comando \texttt{caption} e \texttt{label} antes do ambiente \texttt{tabular}.
    \item Se a legenda for \textbf{depois} da tabela, colocar o comando \texttt{caption} e \texttt{label} antes do ambiente \texttt{tabular}.
  \end{itemize}

\end{frame}

\begin{frame}[fragile]
  \frametitle{Legenda e rótulo}

  \begin{lstlisting}[style=myStyleLatex]
  \begin{table}[<placement>]
    \caption[<short>]{<long>} % legenda antes da tabela
    \label{tab:<label>}
    \begin{tabular}{<cols>}
      (* \vdots *)
    \end{tabular}
  \end{table}
  \end{lstlisting}

\end{frame}

\begin{frame}[fragile]
  \frametitle{Legenda e rótulo}

  \begin{lstlisting}[style=myStyleLatex]
  \begin{table}[<placement>]
    \begin{tabular}{<cols>}
      (* \vdots *)
    \end{tabular}
    \caption[<short>]{<long>} % legenda depois da tabela
    \label{tab:<label>}
  \end{table}
  \end{lstlisting}

\end{frame}

\section{Lista de tabelas}
\begin{frame}[fragile]
  \frametitle{Lista de tabelas}

  \begin{itemize}
    \item O comando para gerar uma lista de tabelas é \lstinline[style=myStyleLatex]!\listoftables!.
  \end{itemize}

\end{frame}

\begin{frame}[allowframebreaks]
  \frametitle{Referências}
  \nocite{*}
  \printbibliography[keyword={inserirTabela}]
\end{frame}


\end{document}